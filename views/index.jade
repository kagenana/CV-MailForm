extends ./layout

block content
  .container
      h2 行動予定表
      button.btn.btn-primary(onClick="location.href='/'")
        i.icon-repeat.icon-white
        | 　表示を更新する
      | 　（60秒毎に自動的に更新されます。 / 毎日0時にリセットされます。）
      table.table.table-bordered.table-striped.table-hover
        //caption 入力履歴
        .control-group
          thead
            tr.table-bordered
              th #
              th.span3 ユーザ名
              th.span1 状態
              th.span3 戻り予定時刻
              th.span8 詳細
              th.span3 更新時刻
          tbody
            - var author_old = ""
            - var index = 0
            for schedule, i in schedules
              if schedules[i].author != author_old
                - author_old = schedules[i].author
                tr
                  - index = index + 1
                  td= index
                  td= schedules[i].author
                  td
                    if schedules[i].subject == "left"
                      span.label.label-success 離席中
                    if schedules[i].subject == "goout"
                      span.label.label-warning 外出中
                    if schedules[i].subject == "exist"
                      span.label.label-info 在席中
                  td
                    if(schedules[i].timeReturn)
                      - var date = encodeDate(schedules[i].timeReturn)
                      p #{date}
                  td= schedules[i].Description
                  td
                    if(schedules[i].timeSubmit)
                      - var date = encodeDate(schedules[i].timeSubmit)
                      p #{date}
                  
                  
              - function encodeDate(date) {
                - var y = date.getFullYear();
                - var m = date.getMonth()+1;
                - var d = date.getDate();
                - m = ('0' + m).slice(-2);
                - d = ('0' + d).slice(-2);
                - var hh = date.getHours()
                - var mm = date.getMinutes();
                - hh = ('0' + hh).slice(-2);
                - mm = ('0' + mm).slice(-2);
                - var w = date.getDay();
                - var week = "";
                - if (w == 0) week = "(日)";
                - if (w == 1) week = "(月)";
                - if (w == 2) week = "(火)";
                - if (w == 3) week = "(水)";
                - if (w == 4) week = "(木)";
                - if (w == 5) week = "(金)";
                - if (w == 6) week = "(土)";
                - return y + "/" + m + "/" + d + week + " " + hh + ":" + mm;
              - };
            script(language="JavaScript")
              setTimeout("location.reload()",1000*60);
  #container